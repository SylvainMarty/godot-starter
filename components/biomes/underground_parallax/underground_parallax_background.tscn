[gd_scene load_steps=11 format=3 uid="uid://b7qoh7ysldlb7"]

[ext_resource type="Texture2D" uid="uid://nvyg2rwbeot3" path="res://assets/art/objects/cave_background.jpg" id="1_3purr"]
[ext_resource type="Texture2D" uid="uid://2dlmwfnq82kl" path="res://assets/art/objects/background_spikes_darker.png" id="2_p1diq"]
[ext_resource type="Shader" path="res://components/shaders/blur_effect.gdshader" id="3_gdcio"]
[ext_resource type="Texture2D" uid="uid://v4gymfdwq4hn" path="res://assets/art/objects/background_spikes.png" id="3_hj4em"]
[ext_resource type="Texture2D" uid="uid://cmunm8uag0qj5" path="res://assets/art/objects/cave_background_ground.png" id="4_0h751"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_rsfuq"]
shader = ExtResource("3_gdcio")
shader_parameter/lod = 0.6

[sub_resource type="Shader" id="Shader_vscjo"]
code = "shader_type canvas_item;
//render_mode unshaded; // optional

// Noise texture
uniform sampler2D noise_texture: repeat_enable, filter_nearest;
// Fog density
uniform float density: hint_range(0.0, 1.0) = 0.25;
// Fog speed
uniform vec2 speed = vec2(0.02, 0.01);


// Called for every pixel the material is visible on
void fragment() {
	// Make the fog slowly move
	vec2 uv = UV + speed * TIME;
	// Sample the noise texture
	float noise = texture(noise_texture, uv).r;
	// Convert the noise from the (0.0, 1.0) range to the (-1.0, 1.0) range
	// and clamp it between 0.0 and 1.0 again
	float fog = clamp(noise * 2.0 - 1.0, 0.0, 1.0);
	// Apply the fog effect
	COLOR.a *= fog * density;
}"

[sub_resource type="FastNoiseLite" id="FastNoiseLite_a83t0"]
seed = 66
frequency = 0.0057

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_4yr7m"]
seamless = true
seamless_blend_skirt = 0.324
noise = SubResource("FastNoiseLite_a83t0")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_qakyv"]
shader = SubResource("Shader_vscjo")
shader_parameter/density = 0.25
shader_parameter/speed = Vector2(0.02, 0.01)
shader_parameter/noise_texture = SubResource("NoiseTexture2D_4yr7m")

[node name="SurfaceParallaxBackground" type="Node2D"]

[node name="FarParallaxBackground" type="ParallaxBackground" parent="."]

[node name="Polygon2D" type="Polygon2D" parent="FarParallaxBackground"]
texture = ExtResource("1_3purr")
polygon = PackedVector2Array(-392, 512, -392, 0, 33000, 0, 33000, 512, 16304, 528)

[node name="FarSpikesParallaxLayer" type="ParallaxLayer" parent="FarParallaxBackground"]
position = Vector2(104, 8)
motion_scale = Vector2(0.1, 0.1)
motion_mirroring = Vector2(1300, 0)

[node name="Sprite2D" type="Sprite2D" parent="FarParallaxBackground/FarSpikesParallaxLayer"]
position = Vector2(-246, 242)
scale = Vector2(0.5, 0.5)
texture = ExtResource("2_p1diq")

[node name="Sprite2D2" type="Sprite2D" parent="FarParallaxBackground/FarSpikesParallaxLayer"]
position = Vector2(250, 242)
scale = Vector2(-0.5, 0.5)
texture = ExtResource("2_p1diq")

[node name="BlurPolygon2D" type="Polygon2D" parent="FarParallaxBackground/FarSpikesParallaxLayer"]
material = SubResource("ShaderMaterial_rsfuq")
position = Vector2(-379.09, 0)
scale = Vector2(1.12414, 1)
polygon = PackedVector2Array(-104, -9, -104, 648, 1056, 648, 1056, 317, 1056, -8)

[node name="CloseSpikeMountainsParallaxLayer" type="ParallaxLayer" parent="FarParallaxBackground"]
position = Vector2(104, 8)
motion_scale = Vector2(0.2, 0.2)
motion_mirroring = Vector2(1300, 0)

[node name="Sprite2D" type="Sprite2D" parent="FarParallaxBackground/CloseSpikeMountainsParallaxLayer"]
modulate = Color(0.804743, 0.804743, 0.804743, 1)
position = Vector2(-246, 242)
scale = Vector2(0.5, 0.5)
texture = ExtResource("3_hj4em")

[node name="Sprite2D3" type="Sprite2D" parent="FarParallaxBackground/CloseSpikeMountainsParallaxLayer"]
modulate = Color(0.804743, 0.804743, 0.804743, 1)
position = Vector2(754, 242)
scale = Vector2(0.5, 0.5)
texture = ExtResource("3_hj4em")

[node name="BlurPolygon2D" type="Polygon2D" parent="FarParallaxBackground/CloseSpikeMountainsParallaxLayer"]
material = SubResource("ShaderMaterial_rsfuq")
position = Vector2(-379.09, 0)
scale = Vector2(1.12414, 1)
polygon = PackedVector2Array(-104, -9, -104, 648, 1056, 648, 1056, 317, 1056, -8)

[node name="CloseGroundParallaxLayer" type="ParallaxLayer" parent="FarParallaxBackground"]
position = Vector2(104, 88)
motion_scale = Vector2(0.3, 0.3)
motion_mirroring = Vector2(1980, 0)

[node name="HillsSprite2D" type="Sprite2D" parent="FarParallaxBackground/CloseGroundParallaxLayer"]
position = Vector2(-246, 278)
scale = Vector2(-0.5, 0.3)
texture = ExtResource("4_0h751")

[node name="HillsSprite2D2" type="Sprite2D" parent="FarParallaxBackground/CloseGroundParallaxLayer"]
position = Vector2(250, 278)
scale = Vector2(0.5, 0.3)
texture = ExtResource("4_0h751")

[node name="HillsSprite2D3" type="Sprite2D" parent="FarParallaxBackground/CloseGroundParallaxLayer"]
position = Vector2(746, 278)
scale = Vector2(-0.5, 0.3)
texture = ExtResource("4_0h751")

[node name="HillsSprite2D4" type="Sprite2D" parent="FarParallaxBackground/CloseGroundParallaxLayer"]
position = Vector2(1234, 278)
scale = Vector2(0.5, 0.3)
texture = ExtResource("4_0h751")

[node name="Fog" type="ColorRect" parent="FarParallaxBackground/CloseGroundParallaxLayer"]
material = SubResource("ShaderMaterial_qakyv")
offset_left = -496.0
offset_top = -88.0
offset_right = 1484.0
offset_bottom = 429.0
color = Color(0, 0, 0, 0.545098)

[node name="ForestParallaxLayer" type="ParallaxLayer" parent="FarParallaxBackground"]
position = Vector2(104, 8)
motion_scale = Vector2(0.3, 0.3)
motion_mirroring = Vector2(1590, 0)

[node name="DarkerForestSprite2D" type="Sprite2D" parent="FarParallaxBackground/ForestParallaxLayer"]
modulate = Color(0.77084, 0.770839, 0.770839, 1)
position = Vector2(-120, 352)
rotation = 3.14159
scale = Vector2(0.3, 0.3)
texture = ExtResource("2_p1diq")

[node name="DarkerForestSprite2D2" type="Sprite2D" parent="FarParallaxBackground/ForestParallaxLayer"]
modulate = Color(0.77084, 0.770839, 0.770839, 1)
position = Vector2(736, 336)
rotation = 3.14159
scale = Vector2(0.35, 0.35)
texture = ExtResource("2_p1diq")

[node name="CloseParallaxBackground" type="ParallaxBackground" parent="."]

[node name="ForestParallaxLayer" type="ParallaxLayer" parent="CloseParallaxBackground"]
position = Vector2(104, 8)
motion_scale = Vector2(1.05, 1.05)
motion_mirroring = Vector2(1800, 0)

[node name="ForestSprite2D" type="Sprite2D" parent="CloseParallaxBackground/ForestParallaxLayer"]
position = Vector2(-248, 256)
rotation = 3.14159
scale = Vector2(0.5, 0.5)
texture = ExtResource("3_hj4em")
